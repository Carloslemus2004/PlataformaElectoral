<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Plataforma Electoral</title>
  <style>
    body { font-family: Arial, sans-serif; margin:20px; }
    h1 { color:#003366; }
    table { border-collapse: collapse; width:100%; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:8px; text-align:center; }
    th { background:#f0f0f0; }
    button { margin:10px; padding:10px; }
  </style>
</head>
<body>
  <h1>Dashboard Electoral</h1>
  <div id="panel"></div>
  <button onclick="exportarResultados()">Exportar Resultados</button>
  <button onclick="limpiarResultados()">Limpiar Votos</button>

<script>
let resultados = JSON.parse(localStorage.getItem("resultados")) || {};

const candidatos = [
  {id:"PRES1", nombre:"Presidente A"},
  {id:"PRES2", nombre:"Presidente B"},
  {id:"PRES3", nombre:"Presidente C"}
];

const jrvs = [
  {jrv_id:"JRV1", nombre:"Mesa 1"},
  {jrv_id:"JRV2", nombre:"Mesa 2"}
];

function render(){
  let html = "<table><tr><th>Mesa</th>";
  candidatos.forEach(c=> html += `<th>${c.nombre}</th>`);
  html += "</tr>";
  jrvs.forEach(jrv=>{
    html += `<tr><td>${jrv.nombre}</td>`;
    candidatos.forEach(c=>{
      let votos = resultados[jrv.jrv_id]?.[c.id] || 0;
      html += `<td><input type="number" min="0" value="${votos}" 
        onchange="actualizarResultado('${jrv.jrv_id}','${c.id}',this.value)"></td>`;
    });
    html += "</tr>";
  });
  html += "</table>";
  document.getElementById("panel").innerHTML = html;
}

function actualizarResultado(jrv_id,candidato_id,votos){
  if(!resultados[jrv_id]) resultados[jrv_id] = {};
  resultados[jrv_id][candidato_id] = parseInt(votos)||0;
  localStorage.setItem("resultados", JSON.stringify(resultados));
}

function exportarResultados(){
  const blob = new Blob([JSON.stringify(resultados,null,2)],{type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "resultados.json";
  a.click();
  URL.revokeObjectURL(url);
}

function limpiarResultados(){
  resultados = {};
  localStorage.removeItem("resultados");
  render();
}

render();
</script>
</body>
</html>
